(function(a){if(!a.Indextank){a.Indextank=new Object()}a.Indextank.InstantLinks=function(c,b){var d=this;d.$el=a(c);d.el=c;d.$el.data("Indextank.InstantLinks",d);d.options=a.extend({},a.Indextank.InstantLinks.defaultOptions,b);d.init=function(){var e=a(d.el.form).data("Indextank.Ize");d.$el.autocomplete({select:function(f,g){window.location.href=g.item[d.options.url]},source:function(g,f){a.ajax({url:e.apiurl+"/v1/indexes/"+e.indexName+"/instantlinks",dataType:"jsonp",data:{query:g.term,field:d.options.name,fetch:d.options.fields},success:function(i){var h=a.map(i.results,function(j){j.queryTerm=g.term;return j});f(h)}})},minLength:d.options.minLength,delay:d.options.delay}).data("autocomplete")._renderItem=function(f,g){var h=a("<li/>").addClass("result").data("item",g);h.append(d.options.format(g,d.options));return h.appendTo(f)}};d.init()};a.Indextank.InstantLinks.defaultOptions={name:"name",url:"url",thumbnail:"thumbnail",description:"description",fields:"name,url,thumbnail,description",minLength:2,delay:100,format:function(g,f){function b(i,h){rx=new RegExp(h,"ig");bolds=a.map(i.match(rx)||[],function(j){return"<span class='highlighted'>"+j+"</span>"});regulars=a(a.map(i.split(rx),function(j){return a("<span></span>").addClass("regular").text(j).get(0)}));return a.each(regulars,function(k,j){a(j).append(bolds[k]||"")})}var e=g[f.name];var d=b(e,g.queryTerm);var c=a("<a></a>").attr("href",g[f.url]);if(g[f.thumbnail]){c.addClass("with-thumbnail");c.append(a("<img />").attr("src",g[f.thumbnail]).css({"max-width":"50px","max-height":"50px"}))}c.append(a("<span/>").addClass("name").append(d));if(g[f.description]){c.addClass("with-description");c.append(a("<span/>").addClass("description").text(g[f.description]))}return c}};a.fn.indextank_InstantLinks=function(b){return this.each(function(){(new a.Indextank.InstantLinks(this,b))})}})(jQuery);