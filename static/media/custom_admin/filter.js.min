function Filter(d,e,b){var c=e.next("ul");var a={};window.location.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(h,g,j,i){a[g]=i});d.each(b,function(g,h){d.each(h.qs,function(k,j){if(j.name in a){if(a[j.name]==j.value){delete a[j.name]}}})});var f=a;c.append('<li class="selected"><a href="?'+d.param(a)+'">All</a></li>');d.each(b,function(g,h){a=f;d.each(h.qs,function(l,k){a[k.name]=k.value});c.append('<li><a href="?'+d.param(a)+'">'+h.title+"</a></li>");var j=true;var i=c.children("li:last");d.each(h.qs,function(l,k){if(!window.location.search.match(d.param([k]))){j=false}});if(j){i.addClass("selected");i.siblings().each(function(){d(this).removeClass("selected")})}})};