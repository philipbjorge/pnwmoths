(function(b){b.jqplot.CategoryAxisRenderer=function(a){b.jqplot.LinearAxisRenderer.call(this);this.sortMergedLabels=false};b.jqplot.CategoryAxisRenderer.prototype=new b.jqplot.LinearAxisRenderer();b.jqplot.CategoryAxisRenderer.prototype.constructor=b.jqplot.CategoryAxisRenderer;b.jqplot.CategoryAxisRenderer.prototype.init=function(k){this.groups=1;this.groupLabels=[];this._groupLabels=[];this._grouped=false;this._barsPerGroup=null;b.extend(true,this,{tickOptions:{formatString:"%d"}},k);var a=this._dataBounds;for(var j=0;j<this._series.length;j++){var i=this._series[j];if(i.groups){this.groups=i.groups}var d=i.data;for(var l=0;l<d.length;l++){if(this.name=="xaxis"||this.name=="x2axis"){if(d[l][0]<a.min||a.min==null){a.min=d[l][0]}if(d[l][0]>a.max||a.max==null){a.max=d[l][0]}}else{if(d[l][1]<a.min||a.min==null){a.min=d[l][1]}if(d[l][1]>a.max||a.max==null){a.max=d[l][1]}}}}if(this.groupLabels.length){this.groups=this.groupLabels.length}};b.jqplot.CategoryAxisRenderer.prototype.createTicks=function(){var I=this._ticks;var a=this.ticks;var G=this.name;var J=this._dataBounds;var s,N;var M,l;var X,Y;var Z,j;if(a.length){if(this.groups>1&&!this._grouped){var K=a.length;var O=parseInt(K/this.groups,10);var W=0;for(var j=O;j<K;j+=O){a.splice(j+W,0," ");W++}this._grouped=true}this.min=0.5;this.max=a.length+0.5;var R=this.max-this.min;this.numberTicks=2*a.length+1;for(j=0;j<a.length;j++){Z=this.min+2*j*R/(this.numberTicks-1);var T=new this.tickRenderer(this.tickOptions);T.showLabel=false;T.setTick(Z,this.name);this._ticks.push(T);var T=new this.tickRenderer(this.tickOptions);T.label=a[j];T.showMark=false;T.showGridline=false;T.setTick(Z+0.5,this.name);this._ticks.push(T)}var T=new this.tickRenderer(this.tickOptions);T.showLabel=false;T.setTick(Z+1,this.name);this._ticks.push(T)}else{if(G=="xaxis"||G=="x2axis"){s=this._plotDimensions.width}else{s=this._plotDimensions.height}if(this.min!=null&&this.max!=null&&this.numberTicks!=null){this.tickInterval=null}if(this.min!=null&&this.max!=null&&this.tickInterval!=null){if(parseInt((this.max-this.min)/this.tickInterval,10)!=(this.max-this.min)/this.tickInterval){this.tickInterval=null}}var i=[];var L=0;var M=0.5;var l,H;var V=false;for(var j=0;j<this._series.length;j++){var S=this._series[j];for(var t=0;t<S.data.length;t++){if(this.name=="xaxis"||this.name=="x2axis"){H=S.data[t][0]}else{H=S.data[t][1]}if(b.inArray(H,i)==-1){V=true;L+=1;i.push(H)}}}if(V&&this.sortMergedLabels){i.sort(function(c,d){return c-d})}this.ticks=i;for(var j=0;j<this._series.length;j++){var S=this._series[j];for(var t=0;t<S.data.length;t++){if(this.name=="xaxis"||this.name=="x2axis"){H=S.data[t][0]}else{H=S.data[t][1]}var Q=b.inArray(H,i)+1;if(this.name=="xaxis"||this.name=="x2axis"){S.data[t][0]=Q}else{S.data[t][1]=Q}}}if(this.groups>1&&!this._grouped){var K=i.length;var O=parseInt(K/this.groups,10);var W=0;for(var j=O;j<K;j+=O+1){i[j]=" "}this._grouped=true}l=L+0.5;if(this.numberTicks==null){this.numberTicks=2*L+1}var R=l-M;this.min=M;this.max=l;var P=0;var U=parseInt(3+s/10,10);var O=parseInt(L/U,10);if(this.tickInterval==null){this.tickInterval=R/(this.numberTicks-1)}for(var j=0;j<this.numberTicks;j++){Z=this.min+j*this.tickInterval;var T=new this.tickRenderer(this.tickOptions);if(j/2==parseInt(j/2,10)){T.showLabel=false;T.showMark=true}else{if(O>0&&P<O){T.showLabel=false;P+=1}else{T.showLabel=true;P=0}T.label=T.formatter(T.formatString,i[(j-1)/2]);T.showMark=false;T.showGridline=false}T.setTick(Z,this.name);this._ticks.push(T)}}};b.jqplot.CategoryAxisRenderer.prototype.draw=function(a,i){if(this.show){this.renderer.createTicks.call(this);var k=0;var p;if(this._elem){this._elem.emptyForce()}this._elem=this._elem||b('<div class="jqplot-axis jqplot-'+this.name+'" style="position:absolute;"></div>');if(this.name=="xaxis"||this.name=="x2axis"){this._elem.width(this._plotDimensions.width)}else{this._elem.height(this._plotDimensions.height)}this.labelOptions.axis=this.name;this._label=new this.labelRenderer(this.labelOptions);if(this._label.show){var l=this._label.draw(a,i);l.appendTo(this._elem)}var m=this._ticks;for(var n=0;n<m.length;n++){var o=m[n];if(o.showLabel&&(!o.isMinorTick||this.showMinorTicks)){var l=o.draw(a,i);l.appendTo(this._elem)}}this._groupLabels=[];for(var n=0;n<this.groupLabels.length;n++){var l=b('<div style="position:absolute;" class="jqplot-'+this.name+'-groupLabel"></div>');l.html(this.groupLabels[n]);this._groupLabels.push(l);l.appendTo(this._elem)}}return this._elem};b.jqplot.CategoryAxisRenderer.prototype.set=function(){var q=0;var h;var i=0;var p=0;var r=(this._label==null)?false:this._label.show;if(this.show){var a=this._ticks;for(var s=0;s<a.length;s++){var o=a[s];if(o.showLabel&&(!o.isMinorTick||this.showMinorTicks)){if(this.name=="xaxis"||this.name=="x2axis"){h=o._elem.outerHeight(true)}else{h=o._elem.outerWidth(true)}if(h>q){q=h}}}var l=0;for(var s=0;s<this._groupLabels.length;s++){var t=this._groupLabels[s];if(this.name=="xaxis"||this.name=="x2axis"){h=t.outerHeight(true)}else{h=t.outerWidth(true)}if(h>l){l=h}}if(r){i=this._label._elem.outerWidth(true);p=this._label._elem.outerHeight(true)}if(this.name=="xaxis"){q+=l+p;this._elem.css({height:q+"px",left:"0px",bottom:"0px"})}else{if(this.name=="x2axis"){q+=l+p;this._elem.css({height:q+"px",left:"0px",top:"0px"})}else{if(this.name=="yaxis"){q+=l+i;this._elem.css({width:q+"px",left:"0px",top:"0px"});if(r&&this._label.constructor==b.jqplot.AxisLabelRenderer){this._label._elem.css("width",i+"px")}}else{q+=l+i;this._elem.css({width:q+"px",right:"0px",top:"0px"});if(r&&this._label.constructor==b.jqplot.AxisLabelRenderer){this._label._elem.css("width",i+"px")}}}}}};b.jqplot.CategoryAxisRenderer.prototype.pack=function(Q,S){var E=this._ticks;var j=this.max;var t=this.min;var K=S.max;var M=S.min;var H=(this._label==null)?false:this._label.show;var i;for(var F in Q){this._elem.css(F,Q[F])}this._offsets=S;var O=K-M;var N=j-t;this.p2u=function(c){return(c-M)*N/O+t};this.u2p=function(c){return(c-t)*O/N+M};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(c){return(c-t)*O/N};this.series_p2u=function(c){return c*N/O+t}}else{this.series_u2p=function(c){return(c-j)*O/N};this.series_p2u=function(c){return c*N/O+j}}if(this.show){if(this.name=="xaxis"||this.name=="x2axis"){for(i=0;i<E.length;i++){var J=E[i];if(J.show&&J.showLabel){var T;if(J.constructor==b.jqplot.CanvasAxisTickRenderer&&J.angle){var I=(this.name=="xaxis")?1:-1;switch(J.labelPosition){case"auto":if(I*J.angle<0){T=-J.getWidth()+J._textRenderer.height*Math.sin(-J._textRenderer.angle)/2}else{T=-J._textRenderer.height*Math.sin(J._textRenderer.angle)/2}break;case"end":T=-J.getWidth()+J._textRenderer.height*Math.sin(-J._textRenderer.angle)/2;break;case"start":T=-J._textRenderer.height*Math.sin(J._textRenderer.angle)/2;break;case"middle":T=-J.getWidth()/2+J._textRenderer.height*Math.sin(-J._textRenderer.angle)/2;break;default:T=-J.getWidth()/2+J._textRenderer.height*Math.sin(-J._textRenderer.angle)/2;break}}else{T=-J.getWidth()/2}var w=this.u2p(J.value)+T+"px";J._elem.css("left",w);J.pack()}}var a=["bottom",0];if(H){var L=this._label._elem.outerWidth(true);this._label._elem.css("left",M+O/2-L/2+"px");if(this.name=="xaxis"){this._label._elem.css("bottom","0px");a=["bottom",this._label._elem.outerHeight(true)]}else{this._label._elem.css("top","0px");a=["top",this._label._elem.outerHeight(true)]}this._label.pack()}var R=parseInt(this._ticks.length/this.groups,10);for(i=0;i<this._groupLabels.length;i++){var G=0;var P=0;for(var p=i*R;p<=(i+1)*R;p++){if(this._ticks[p]._elem&&this._ticks[p].label!=" "){var J=this._ticks[p]._elem;var F=J.position();G+=F.left+J.outerWidth(true)/2;P++}}G=G/P;this._groupLabels[i].css({left:(G-this._groupLabels[i].outerWidth(true)/2)});this._groupLabels[i].css(a[0],a[1])}}else{for(i=0;i<E.length;i++){var J=E[i];if(J.show&&J.showLabel){var T;if(J.constructor==b.jqplot.CanvasAxisTickRenderer&&J.angle){var I=(this.name=="yaxis")?1:-1;switch(J.labelPosition){case"auto":case"end":if(I*J.angle<0){T=-J._textRenderer.height*Math.cos(-J._textRenderer.angle)/2}else{T=-J.getHeight()+J._textRenderer.height*Math.cos(J._textRenderer.angle)/2}break;case"start":if(J.angle>0){T=-J._textRenderer.height*Math.cos(-J._textRenderer.angle)/2}else{T=-J.getHeight()+J._textRenderer.height*Math.cos(J._textRenderer.angle)/2}break;case"middle":T=-J.getHeight()/2;break;default:T=-J.getHeight()/2;break}}else{T=-J.getHeight()/2}var w=this.u2p(J.value)+T+"px";J._elem.css("top",w);J.pack()}}var a=["left",0];if(H){var h=this._label._elem.outerHeight(true);this._label._elem.css("top",K-O/2-h/2+"px");if(this.name=="yaxis"){this._label._elem.css("left","0px");a=["left",this._label._elem.outerWidth(true)]}else{this._label._elem.css("right","0px");a=["right",this._label._elem.outerWidth(true)]}this._label.pack()}var R=parseInt(this._ticks.length/this.groups,10);for(i=0;i<this._groupLabels.length;i++){var G=0;var P=0;for(var p=i*R;p<=(i+1)*R;p++){if(this._ticks[p]._elem&&this._ticks[p].label!=" "){var J=this._ticks[p]._elem;var F=J.position();G+=F.top+J.outerHeight()/2;P++}}G=G/P;this._groupLabels[i].css({top:G-this._groupLabels[i].outerHeight()/2});this._groupLabels[i].css(a[0],a[1])}}}}})(jQuery);