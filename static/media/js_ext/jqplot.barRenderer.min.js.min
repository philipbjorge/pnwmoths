(function(u){u.jqplot.BarRenderer=function(){u.jqplot.LineRenderer.call(this)};u.jqplot.BarRenderer.prototype=new u.jqplot.LineRenderer();u.jqplot.BarRenderer.prototype.constructor=u.jqplot.BarRenderer;u.jqplot.BarRenderer.prototype.init=function(d,b){this.barPadding=8;this.barMargin=10;this.barDirection="vertical";this.barWidth=null;this.shadowOffset=2;this.shadowDepth=5;this.shadowAlpha=0.08;this.waterfall=false;this.groups=1;this.varyBarColor=false;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];this.transposedData=true;this.renderer.animation={show:false,direction:"down",speed:3000,_supported:true};this._type="bar";if(d.highlightMouseDown&&d.highlightMouseOver==null){d.highlightMouseOver=false}u.extend(true,this,d);u.extend(true,this.renderer,d);this.fill=true;if(this.barDirection==="horizontal"&&this.rendererOptions.animation&&this.rendererOptions.animation.direction==null){this.renderer.animation.direction="left"}if(this.waterfall){this.fillToZero=false;this.disableStack=true}if(this.barDirection=="vertical"){this._primaryAxis="_xaxis";this._stackAxis="y";this.fillAxis="y"}else{this._primaryAxis="_yaxis";this._stackAxis="x";this.fillAxis="x"}this._highlightedPoint=null;this._plotSeriesInfo=null;this._dataColors=[];this._barPoints=[];var c={lineJoin:"miter",lineCap:"round",fill:true,isarc:false,strokeStyle:this.color,fillStyle:this.color,closePath:this.fill};this.renderer.shapeRenderer.init(c);var a={lineJoin:"miter",lineCap:"round",fill:true,isarc:false,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,closePath:this.fill};this.renderer.shadowRenderer.init(a);b.postInitHooks.addOnce(q);b.postDrawHooks.addOnce(p);b.eventListenerHooks.addOnce("jqplotMouseMove",w);b.eventListenerHooks.addOnce("jqplotMouseDown",x);b.eventListenerHooks.addOnce("jqplotMouseUp",n);b.eventListenerHooks.addOnce("jqplotClick",t);b.eventListenerHooks.addOnce("jqplotRightClick",m)};function r(j,d,e,g){if(this.rendererOptions.barDirection=="horizontal"){this._stackAxis="x";this._primaryAxis="_yaxis"}if(this.rendererOptions.waterfall==true){this._data=u.extend(true,[],this.data);var a=0;var i=(!this.rendererOptions.barDirection||this.rendererOptions.barDirection==="vertical"||this.transposedData===false)?1:0;for(var c=0;c<this.data.length;c++){a+=this.data[c][i];if(c>0){this.data[c][i]+=this.data[c-1][i]}}this.data[this.data.length]=(i==1)?[this.data.length+1,a]:[a,this.data.length+1];this._data[this._data.length]=(i==1)?[this._data.length+1,a]:[a,this._data.length+1]}if(this.rendererOptions.groups>1){this.breakOnNull=true;var f=this.data.length;var h=parseInt(f/this.rendererOptions.groups,10);var b=0;for(var c=h;c<f;c+=h){this.data.splice(c+b,0,[null,null]);b++}for(c=0;c<this.data.length;c++){if(this._primaryAxis=="_xaxis"){this.data[c][0]=c+1}else{this.data[c][1]=c+1}}}}u.jqplot.preSeriesInitHooks.push(r);u.jqplot.BarRenderer.prototype.calcSeriesNumbers=function(){var d=0;var c=0;var e=this[this._primaryAxis];var f,g,b;for(var a=0;a<e._series.length;a++){g=e._series[a];if(g===this){b=a}if(g.renderer.constructor==u.jqplot.BarRenderer){d+=g.data.length;c+=1}}return[d,c,b]};u.jqplot.BarRenderer.prototype.setBarWidth=function(){var c;var f=0;var e=0;var a=this[this._primaryAxis];var g,b,i;var h=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);f=h[0];e=h[1];var j=a.numberTicks;var d=(j-1)/2;if(a.name=="xaxis"||a.name=="x2axis"){if(this._stack){this.barWidth=(a._offsets.max-a._offsets.min)/f*e-this.barMargin}else{this.barWidth=((a._offsets.max-a._offsets.min)/d-this.barPadding*(e-1)-this.barMargin*2)/e}}else{if(this._stack){this.barWidth=(a._offsets.min-a._offsets.max)/f*e-this.barMargin}else{this.barWidth=((a._offsets.min-a._offsets.max)/d-this.barPadding*(e-1)-this.barMargin*2)/e}}return[f,e]};function s(g){var e=[];for(var c=0;c<g.length;c++){var d=u.jqplot.getColorComponents(g[c]);var a=[d[0],d[1],d[2]];var b=a[0]+a[1]+a[2];for(var f=0;f<3;f++){a[f]=(b>570)?a[f]*0.8:a[f]+0.3*(255-a[f]);a[f]=parseInt(a[f],10)}e.push("rgb("+a[0]+","+a[1]+","+a[2]+")")}return e}u.jqplot.BarRenderer.prototype.draw=function(U,g,aa){var l;var e=u.extend({},aa);var Q=(e.shadow!=undefined)?e.shadow:this.shadow;var b=(e.showLine!=undefined)?e.showLine:this.showLine;var S=(e.fill!=undefined)?e.fill:this.fill;var ab=this.xaxis;var j=this.yaxis;var i=this._xaxis.series_u2p;var h=this._yaxis.series_u2p;var W,Y;this._dataColors=[];this._barPoints=[];if(this.barWidth==null){this.renderer.setBarWidth.call(this)}var c=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);var k=c[0];var O=c[1];var V=c[2];var P=[];if(this._stack){this._barNudge=0}else{this._barNudge=(-Math.abs(O/2-0.5)+V)*(this.barWidth+this.barPadding)}if(b){var R=new u.jqplot.ColorGenerator(this.negativeSeriesColors);var Z=new u.jqplot.ColorGenerator(this.seriesColors);var d=R.get(this.index);if(!this.useNegativeColors){d=e.fillStyle}var T=e.fillStyle;var X;var a;var ac;if(this.barDirection=="vertical"){for(var l=0;l<g.length;l++){if(this.data[l][1]==null){continue}P=[];X=g[l][0]+this._barNudge;ac;if(this._stack&&this._prevGridData.length){ac=this._prevGridData[l][1]}else{if(this.fillToZero){ac=this._yaxis.series_u2p(0)}else{if(this.waterfall&&l>0&&l<this.gridData.length-1){ac=this.gridData[l-1][1]}else{if(this.waterfall&&l==0&&l<this.gridData.length-1){if(this._yaxis.min<=0&&this._yaxis.max>=0){ac=this._yaxis.series_u2p(0)}else{if(this._yaxis.min>0){ac=U.canvas.height}else{ac=0}}}else{if(this.waterfall&&l==this.gridData.length-1){if(this._yaxis.min<=0&&this._yaxis.max>=0){ac=this._yaxis.series_u2p(0)}else{if(this._yaxis.min>0){ac=U.canvas.height}else{ac=0}}}else{ac=U.canvas.height}}}}}if((this.fillToZero&&this._plotData[l][1]<0)||(this.waterfall&&this._data[l][1]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){e.fillStyle=R.next()}else{e.fillStyle=Z.next()}}else{e.fillStyle=d}}else{if(this.varyBarColor&&!this._stack){e.fillStyle=Z.next()}else{e.fillStyle=T}}if(!this.fillToZero||this._plotData[l][1]>=0){P.push([X-this.barWidth/2,ac]);P.push([X-this.barWidth/2,g[l][1]]);P.push([X+this.barWidth/2,g[l][1]]);P.push([X+this.barWidth/2,ac])}else{P.push([X-this.barWidth/2,g[l][1]]);P.push([X-this.barWidth/2,ac]);P.push([X+this.barWidth/2,ac]);P.push([X+this.barWidth/2,g[l][1]])}this._barPoints.push(P);if(Q&&!this._stack){var f=u.extend(true,{},e);delete f.fillStyle;this.renderer.shadowRenderer.draw(U,P,f)}var ad=e.fillStyle||this.color;this._dataColors.push(ad);this.renderer.shapeRenderer.draw(U,P,e)}}else{if(this.barDirection=="horizontal"){for(var l=0;l<g.length;l++){if(this.data[l][0]==null){continue}P=[];X=g[l][1]-this._barNudge;a;if(this._stack&&this._prevGridData.length){a=this._prevGridData[l][0]}else{if(this.fillToZero){a=this._xaxis.series_u2p(0)}else{if(this.waterfall&&l>0&&l<this.gridData.length-1){a=this.gridData[l-1][1]}else{if(this.waterfall&&l==0&&l<this.gridData.length-1){if(this._xaxis.min<=0&&this._xaxis.max>=0){a=this._xaxis.series_u2p(0)}else{if(this._xaxis.min>0){a=0}else{a=U.canvas.width}}}else{if(this.waterfall&&l==this.gridData.length-1){if(this._xaxis.min<=0&&this._xaxis.max>=0){a=this._xaxis.series_u2p(0)}else{if(this._xaxis.min>0){a=0}else{a=U.canvas.width}}}else{a=0}}}}}if((this.fillToZero&&this._plotData[l][1]<0)||(this.waterfall&&this._data[l][1]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){e.fillStyle=R.next()}else{e.fillStyle=Z.next()}}}else{if(this.varyBarColor&&!this._stack){e.fillStyle=Z.next()}else{e.fillStyle=T}}if(!this.fillToZero||this._plotData[l][0]>=0){P.push([a,X+this.barWidth/2]);P.push([a,X-this.barWidth/2]);P.push([g[l][0],X-this.barWidth/2]);P.push([g[l][0],X+this.barWidth/2])}else{P.push([g[l][0],X+this.barWidth/2]);P.push([g[l][0],X-this.barWidth/2]);P.push([a,X-this.barWidth/2]);P.push([a,X+this.barWidth/2])}this._barPoints.push(P);if(Q&&!this._stack){var f=u.extend(true,{},e);delete f.fillStyle;this.renderer.shadowRenderer.draw(U,P,f)}var ad=e.fillStyle||this.color;this._dataColors.push(ad);this.renderer.shapeRenderer.draw(U,P,e)}}}}if(this.highlightColors.length==0){this.highlightColors=u.jqplot.computeHighlightColors(this._dataColors)}else{if(typeof(this.highlightColors)=="string"){var c=this.highlightColors;this.highlightColors=[];for(var l=0;l<this._dataColors.length;l++){this.highlightColors.push(c)}}}};u.jqplot.BarRenderer.prototype.drawShadow=function(b,j,P){var M;var g=(P!=undefined)?P:{};var K=(g.shadow!=undefined)?g.shadow:this.shadow;var f=(g.showLine!=undefined)?g.showLine:this.showLine;var a=(g.fill!=undefined)?g.fill:this.fill;var Q=this.xaxis;var J=this.yaxis;var i=this._xaxis.series_u2p;var I=this._yaxis.series_u2p;var c,O,e,k,l,L;if(this._stack&&this.shadow){if(this.barWidth==null){this.renderer.setBarWidth.call(this)}var h=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);k=h[0];l=h[1];L=h[2];if(this._stack){this._barNudge=0}else{this._barNudge=(-Math.abs(l/2-0.5)+L)*(this.barWidth+this.barPadding)}if(f){if(this.barDirection=="vertical"){for(var M=0;M<j.length;M++){if(this.data[M][1]==null){continue}O=[];var N=j[M][0]+this._barNudge;var R;if(this._stack&&this._prevGridData.length){R=this._prevGridData[M][1]}else{if(this.fillToZero){R=this._yaxis.series_u2p(0)}else{R=b.canvas.height}}O.push([N-this.barWidth/2,R]);O.push([N-this.barWidth/2,j[M][1]]);O.push([N+this.barWidth/2,j[M][1]]);O.push([N+this.barWidth/2,R]);this.renderer.shadowRenderer.draw(b,O,g)}}else{if(this.barDirection=="horizontal"){for(var M=0;M<j.length;M++){if(this.data[M][0]==null){continue}O=[];var N=j[M][1]-this._barNudge;var d;if(this._stack&&this._prevGridData.length){d=this._prevGridData[M][0]}else{d=0}O.push([d,N+this.barWidth/2]);O.push([j[M][0],N+this.barWidth/2]);O.push([j[M][0],N-this.barWidth/2]);O.push([d,N-this.barWidth/2]);this.renderer.shadowRenderer.draw(b,O,g)}}}}}};function q(b,c,a){for(var d=0;d<this.series.length;d++){if(this.series[d].renderer.constructor==u.jqplot.BarRenderer){if(this.series[d].highlightMouseOver){this.series[d].highlightMouseDown=false}}}}function p(){if(this.plugins.barRenderer&&this.plugins.barRenderer.highlightCanvas){this.plugins.barRenderer.highlightCanvas.resetCanvas();this.plugins.barRenderer.highlightCanvas=null}this.plugins.barRenderer={highlightedSeriesIndex:null};this.plugins.barRenderer.highlightCanvas=new u.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.barRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-barRenderer-highlight-canvas",this._plotDimensions,this));this.plugins.barRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(a){o(a.data.plot)})}function v(b,c,e,f){var g=b.series[c];var a=b.plugins.barRenderer.highlightCanvas;a._ctx.clearRect(0,0,a._ctx.canvas.width,a._ctx.canvas.height);g._highlightedPoint=e;b.plugins.barRenderer.highlightedSeriesIndex=c;var d={fillStyle:g.highlightColors[e]};g.renderer.shapeRenderer.draw(a._ctx,f,d);a=null}function o(b){var a=b.plugins.barRenderer.highlightCanvas;a._ctx.clearRect(0,0,a._ctx.canvas.width,a._ctx.canvas.height);for(var c=0;c<b.series.length;c++){b.series[c]._highlightedPoint=null}b.plugins.barRenderer.highlightedSeriesIndex=null;b.target.trigger("jqplotDataUnhighlight");a=null}function w(e,f,b,c,d){if(c){var g=[c.seriesIndex,c.pointIndex,c.data];var h=jQuery.Event("jqplotDataMouseOver");h.pageX=e.pageX;h.pageY=e.pageY;d.target.trigger(h,g);if(d.series[g[0]].highlightMouseOver&&!(g[0]==d.plugins.barRenderer.highlightedSeriesIndex&&g[1]==d.series[g[0]]._highlightedPoint)){var a=jQuery.Event("jqplotDataHighlight");a.pageX=e.pageX;a.pageY=e.pageY;d.target.trigger(a,g);v(d,c.seriesIndex,c.pointIndex,c.points)}}else{if(c==null){o(d)}}}function x(e,f,b,c,d){if(c){var g=[c.seriesIndex,c.pointIndex,c.data];if(d.series[g[0]].highlightMouseDown&&!(g[0]==d.plugins.barRenderer.highlightedSeriesIndex&&g[1]==d.series[g[0]]._highlightedPoint)){var a=jQuery.Event("jqplotDataHighlight");a.pageX=e.pageX;a.pageY=e.pageY;d.target.trigger(a,g);v(d,c.seriesIndex,c.pointIndex,c.points)}}else{if(c==null){o(d)}}}function n(e,f,b,c,d){var a=d.plugins.barRenderer.highlightedSeriesIndex;if(a!=null&&d.series[a].highlightMouseDown){o(d)}}function t(e,f,b,c,d){if(c){var g=[c.seriesIndex,c.pointIndex,c.data];var a=jQuery.Event("jqplotDataClick");a.pageX=e.pageX;a.pageY=e.pageY;d.target.trigger(a,g)}}function m(e,f,b,c,d){if(c){var g=[c.seriesIndex,c.pointIndex,c.data];var a=d.plugins.barRenderer.highlightedSeriesIndex;if(a!=null&&d.series[a].highlightMouseDown){o(d)}var h=jQuery.Event("jqplotDataRightClick");h.pageX=e.pageX;h.pageY=e.pageY;d.target.trigger(h,g)}}})(jQuery);